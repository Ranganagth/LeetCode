[2975. Maximum Square Area by Removing Fences From a Field](https://leetcode.com/problems/maximum-square-area-by-removing-fences-from-a-field/)

# Intuition

Removing fences merges adjacent strips of land.

* Horizontal fences define **horizontal strip heights**
* Vertical fences define **vertical strip widths**

A square field of side `k` exists **iff**:

* there is a horizontal gap of length `k`
* there is a vertical gap of length `k`

So the task reduces to:

> Find the **largest common length** that appears as a difference between two horizontal fence positions and also between two vertical fence positions.

If no common length exists → impossible.

## Key Observations

1. The outer boundary fences **always exist** and cannot be removed.

   * Horizontal boundaries at `1` and `m`
   * Vertical boundaries at `1` and `n`
2. Any square side length must be the difference of **two fence coordinates**.
3. Fence count ≤ 600 → `O(k²)` difference enumeration is acceptable.

---

# Approach

1. Add boundary fences:

   * Horizontal: `[1, ...hFences, m]`
   * Vertical: `[1, ...vFences, n]`
2. Sort both arrays.
3. Compute **all positive differences** between pairs of horizontal fences → `H`
4. Compute **all positive differences** between pairs of vertical fences → `V`
5. Find the **maximum value present in both `H` and `V`**
6. Return `side² % (1e9+7)` or `-1` if no match exists

---

# Complexity

* Fence count ≤ 602
* Difference enumeration:
  **Time:** `O(k²)`
  **Space:** `O(k²)` worst case
* Fully acceptable under constraints

---

# Code

```ts
function maximumSquareArea(
    m: number,
    n: number,
    hFences: number[],
    vFences: number[],
): number {
    const MOD = 1_000_000_007;

    const computeDiffs = (arr: number[]): Set<number> => {
        arr.sort((a, b) => a - b);
        const diffs = new Set<number>();
        for (let i = 0; i < arr.length; i++) {
            for (let j = i + 1; j < arr.length; j++) {
                diffs.add(arr[j] - arr[i]);
            }
        }
        return diffs;
    };

    const h = [1, ...hFences, m];
    const v = [1, ...vFences, n];

    const hDiffs = computeDiffs(h);
    const vDiffs = computeDiffs(v);

    let maxSide = 0;
    for (const d of hDiffs) {
        if (vDiffs.has(d)) {
            maxSide = Math.max(maxSide, d);
        }
    }

    if (maxSide === 0) return -1;
    return Number((BigInt(maxSide) * BigInt(maxSide)) % BigInt(MOD));
};

```

---

# Example Walkthrough

### Example 1

```
m = 4, n = 3
hFences = [2,3]
vFences = [2]
```

After adding boundaries:

```
Horizontal: [1,2,3,4]
Vertical:   [1,2,3]
```

Horizontal differences:

```
{1,2,3}
```

Vertical differences:

```
{1,2}
```

Common maximum side:

```
2
```

Area:

```
2² = 4
```


### Example 2

```
m = 6, n = 7
hFences = [2]
vFences = [4]
```

Horizontal diffs:

```
{1,4,5}
```

Vertical diffs:

```
{3,6}
```

No common length → `-1`

---

## Final Insight

* The problem is **pure interval math**
* Geometry is irrelevant once reduced to fence distances
* The square’s side must exist **in both dimensions**
* Boundary fences are critical and must always be included
