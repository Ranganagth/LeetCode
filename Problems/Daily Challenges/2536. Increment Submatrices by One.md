[2536. Increment Submatrices by One](https://leetcode.com/problems/increment-submatrices-by-one/)

# Intuition

Naively updating every cell inside each submatrix is too slow (up to 500×500×10⁴ operations).
We need a method that updates submatrices in **O(1)** per query.
A 2D difference matrix lets us mark increments only on the borders, and then a final prefix-sum reconstruction fills in the full matrix efficiently.

---

# Approach

1. Create an n×n matrix `diff` filled with 0.
2. For each query `[r1, c1, r2, c2]`, update the 2D difference matrix:

   * `diff[r1][c1] += 1`
   * if `c2 + 1 < n`: `diff[r1][c2+1] -= 1`
   * if `r2 + 1 < n`: `diff[r2+1][c1] -= 1`
   * if both valid: `diff[r2+1][c2+1] += 1`
3. Convert `diff` into the final matrix via 2D prefix sums:

   * First prefix rows
   * Then prefix columns
4. Return the resulting matrix.

This reconstructs exactly how many increments each cell received.

---

# Complexity

* Time complexity: **O(n² + q)**
* Space complexity: **O(n²)**

---

# Code

```typescript
function rangeAddQueries(n: number, queries: number[][]): number[][] {
  const diff: number[][] = Array.from({ length: n }, () => Array(n).fill(0));

  for (const [r1, c1, r2, c2] of queries) {
    diff[r1][c1] += 1;
    if (c2 + 1 < n) diff[r1][c2 + 1] -= 1;
    if (r2 + 1 < n) diff[r2 + 1][c1] -= 1;
    if (r2 + 1 < n && c2 + 1 < n) diff[r2 + 1][c2 + 1] += 1;
  }

  // Prefix sum horizontally
  for (let r = 0; r < n; r++) {
    for (let c = 1; c < n; c++) {
      diff[r][c] += diff[r][c - 1];
    }
  }

  // Prefix sum vertically
  for (let c = 0; c < n; c++) {
    for (let r = 1; r < n; r++) {
      diff[r][c] += diff[r - 1][c];
    }
  }

  return diff;
};

```

---

# Example Walkthrough

Example:
n = 3
queries = [[1,1,2,2], [0,0,1,1]]

### Step 1: Start with diff = all zeros.

### Step 2: Apply first query [1,1,2,2]

Updates:

* diff[1][1] += 1
* diff[1][3] invalid
* diff[3][1] invalid
* diff[3][3] invalid

Current diff:

```
0 0 0
0 1 0
0 0 1  (implicitly after prefix reconstruction)
```

### Step 3: Apply second query [0,0,1,1]

Updates:

* diff[0][0] += 1
* diff[0][2] -= 1
* diff[2][0] -= 1
* diff[2][2] += 1

### After all queries, diff looks like (before prefix):

```
1   0  -1
0   1   0
-1  0   1
```

### Step 4: Prefix rows then columns reconstruct final matrix:

Final:

```
1 1 0
1 2 1
0 1 1
```
