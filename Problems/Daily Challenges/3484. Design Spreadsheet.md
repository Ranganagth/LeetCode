[3484. Design Spreadsheet](https://leetcode.com/problems/design-spreadsheet/)

## Problem Restatement

We’re designing a **spreadsheet** with:
- 26 columns (`A`–`Z`)
- `rows` rows (up to 1000)
- Each cell holds an integer (0–100,000).  

We need to support:
1. `setCell(cell, value)` → assign a value to a cell.
2. `resetCell(cell)` → reset to 0.
3. `getValue(formula)` → evaluate a formula `=X+Y` where `X` and `Y` are:
   - Cell references like `"A1"`, `"B2"`, etc.
   - Or plain integers.

Default for unset cells = 0.

---

# Intuition
- The spreadsheet is essentially a **2D grid** (`rows x 26`).
- But storing as a **map of cellId → value** is more memory-efficient, since not all cells are explicitly set.
- A **formula evaluation** is always just `X + Y`. So parsing is simple:
  - Remove `=`.
  - Split by `+`.
  - For each operand:
    - If it looks like a cell reference → lookup value (default 0 if unset).
    - Otherwise → parse as integer.
- Return the sum.

---

# Approach
### Data structures:
- A **map<string, number>** (`cellId → value`) to store only modified cells.

### Parsing a cell:
- `cell` like `"A1"` → directly use `"A1"` as a string key in map.
- No need to convert to indices since we just lookup by string.

### Operations:
1. **setCell(cell, value)** → store `map[cell] = value`.
2. **resetCell(cell)** → set `map[cell] = 0` or remove key.
3. **getValue(formula)**:
   - Parse into operands.
   - Convert each operand into either:
     - A number, or
     - Look up from map (default 0).
   - Return sum.

---

# Complexity

- **setCell/resetCell**: O(1) (hash map operations).
- **getValue**: O(1) (two lookups + addition).
- Space: O(K), where K is number of cells explicitly set (≤ 10^4 operations).

---

# Code

```typescript
class Spreadsheet {
    private cells: Map<string, number>;
    private rows: number;

    constructor(rows: number) {
        this.rows = rows;
        this.cells = new Map();
    }

    setCell(cell: string, value: number): void {
        this.cells.set(cell, value);
    }

    resetCell(cell: string): void {
        this.cells.set(cell, 0);
    }

    getValue(formula: string): number {
        // Remove '=' and split into operands
        const parts = formula.slice(1).split("+");
        let sum = 0;

        for (const part of parts) {
            if (this.isCellReference(part)) {
                sum += this.cells.get(part) ?? 0;
            } else {
                sum += parseInt(part, 10);
            }
        }

        return sum;
    }

    private isCellReference(token: string): boolean {
        // Cell reference: starts with a capital letter followed by digits
        return /^[A-Z][0-9]+$/.test(token);
    }
};

```

---

## Example Walkthrough

### Input
```
["Spreadsheet", "getValue", "setCell", "getValue", "setCell", "getValue", "resetCell", "getValue"]
[[3], ["=5+7"], ["A1", 10], ["=A1+6"], ["B2", 15], ["=A1+B2"], ["A1"], ["=A1+B2"]]
```

### Execution
1. `Spreadsheet(3)`  
   → 3 rows, all cells initialized to 0.

2. `getValue("=5+7")`  
   → Parse → [5, 7] → return **12**.

3. `setCell("A1", 10)`  
   → Map = { A1: 10 }.

4. `getValue("=A1+6")`  
   → A1 = 10, +6 → return **16**.

5. `setCell("B2", 15)`  
   → Map = { A1: 10, B2: 15 }.

6. `getValue("=A1+B2")`  
   → 10 + 15 → return **25**.

7. `resetCell("A1")`  
   → Map = { A1: 0, B2: 15 }.

8. `getValue("=A1+B2")`  
   → 0 + 15 → return **15**.

### Output
```
[null, 12, null, 16, null, 25, null, 15]
```

---
