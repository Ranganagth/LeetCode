[3623. Count Number of Trapezoids I](https://leetcode.com/problems/count-number-of-trapezoids-i/)

# Intuition

The trapezoid definition allows **the two horizontal sides to be of different lengths**. The only requirement is:

- Choose a top horizontal segment: two points with same y.
    
- Choose a bottom horizontal segment: two points with same y.
    
- Their y-coordinates must be different.
    

That’s it. No slope checks needed because any two horizontal lines are automatically parallel.

So the problem reduces to:

> Count ways to pick **one pair** from one horizontal line and **one pair** from another horizontal line.

---

# Approach

1. Create a hashmap `freq[y]` storing how many points exist on each horizontal line.
2. For each horizontal line where `count >= 2`, compute `pairs = count * (count - 1) / 2`.
   This gives the number of distinct point pairs on that line.
3. Store all valid pair counts into an array.
4. For every combination of two different horizontal lines, the number of trapezoids formed is:

```
result += pairs[i] * pairs[j]
```

5. Use modulo arithmetic due to large values.

This ensures each valid configuration uses two points from one horizontal line and two from another - forming a trapezoid with horizontal parallel sides.

---

# Complexity

**Time Complexity:** `O(n log n)` due to sorting/grouping
**Space Complexity:** `O(n)` for the map

---

# Code

```ts
function countTrapezoids(points: number[][]): number {
    const MOD = 1_000_000_007;
    const freq = new Map<number, number>();

    // Count points by y-coordinate
    for (const [x, y] of points) {
        freq.set(y, (freq.get(y) || 0) + 1);
    }

    // Compute number of ways to pick pairs from each y-level
    const pairCounts: number[] = [];

    for (const count of freq.values()) {
        if (count >= 2) {
            const pairs = (BigInt(count) * BigInt(count - 1) / 2n) % BigInt(MOD);
            pairCounts.push(Number(pairs));
        }
    }

    // If fewer than 2 levels can form pairs, no trapezoid possible
    if (pairCounts.length < 2) return 0;

    let result = 0n;

    // Count combinations: sum over pairs[i] * pairs[j] for all i < j
    for (let i = 0; i < pairCounts.length; i++) {
        for (let j = i + 1; j < pairCounts.length; j++) {
            result += BigInt(pairCounts[i]) * BigInt(pairCounts[j]);
            result %= BigInt(MOD);
        }
    }

    return Number(result);
}
```

---

# Example Walkthrough

#### Input:

```
points = [[1,0],[2,0],[3,0],[2,2],[3,2]]
```

#### Step 1: Group by y

```
y=0 → 3 points → pair count = C(3,2) = 3
y=2 → 2 points → pair count = C(2,2) = 1
```

#### Step 2: Multiply combinations

```
Total trapezoids = 3 * 1 = 3
```

#### Output:

```
3
```

---
